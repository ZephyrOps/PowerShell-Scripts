<# This script is designed to take a .csv formatted list of groups in a Groups.txt file and pull a recursive report of the users in each group. #>

$Groups = Get-Content -Path 'C:\Users\44724\Desktop\Scripting\Groups.txt'

foreach ($Group in $Groups)
{
Get-ADGroupMember -Identity $Group  -Recursive | 
Get-ADUser -Properties Mail | 
select name,mail,samaccountname | 
export-csv -Path "C:\Users\44724\Desktop\Scripting\Export\$Group.csv"  -NoTypeInformation
}
